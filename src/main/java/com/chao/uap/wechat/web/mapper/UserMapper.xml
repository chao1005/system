<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hyetec.uap.wechat.mapper.UserMapper" >
  <!--
  Copyright (c) 2017 by Hyetec  Corporation all right reserved.
  2017年11月20日 11:09
  -->
  <resultMap id="BaseResultMap" type="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="pk_id" property="pkId" jdbcType="BIGINT" />
    <result column="login_name" property="loginName" jdbcType="VARCHAR" />
    <result column="salt" property="salt" jdbcType="VARCHAR" />
    <result column="password" property="password" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="job_num" property="jobNum" jdbcType="VARCHAR" />
    <result column="openid" property="openid" jdbcType="VARCHAR" />
    <result column="category" property="category" jdbcType="BIGINT" />
    <result column="reference" property="reference" jdbcType="VARCHAR" />
    <result column="mobile" property="mobile" jdbcType="VARCHAR" />
    <result column="email" property="email" jdbcType="VARCHAR" />
    <result column="phone" property="phone" jdbcType="VARCHAR" />
    <result column="identity_type" property="identityType" jdbcType="BIGINT" />
    <result column="identity_num" property="identityNum" jdbcType="VARCHAR" />
    <result column="img" property="img" jdbcType="VARCHAR" />
    <result column="address" property="address" jdbcType="VARCHAR" />
    <result column="sex" property="sex" jdbcType="BIGINT" />
    <result column="status" property="status" jdbcType="INTEGER" />
    <result column="check_status" property="checkStatus" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    pk_id, login_name, salt, password, user_name, job_num, openid, category, reference, 
    mobile, email, phone, identity_type, identity_num, img, address, sex, status, check_status ,create_time
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from f_user
    where pk_id = #{pkId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from f_user
    where pk_id = #{pkId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Long" keyProperty="pkId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into f_user (login_name, salt, password, 
      user_name, job_num, openid, 
      category, reference, mobile, 
      email, phone, identity_type, 
      identity_num, img, address, 
      sex, status,check_status, create_time
      )
    values (#{loginName,jdbcType=VARCHAR}, #{salt,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR}, 
      #{userName,jdbcType=VARCHAR}, #{jobNum,jdbcType=VARCHAR}, #{openid,jdbcType=VARCHAR}, 
      #{category,jdbcType=BIGINT}, #{reference,jdbcType=VARCHAR}, #{mobile,jdbcType=VARCHAR}, 
      #{email,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR}, #{identityType,jdbcType=BIGINT}, 
      #{identityNum,jdbcType=VARCHAR}, #{img,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR}, 
      #{sex,jdbcType=BIGINT}, #{status,jdbcType=INTEGER}, #{checkStatus,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Long" keyProperty="pkId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into f_user
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="loginName != null" >
        login_name,
      </if>
      <if test="salt != null" >
        salt,
      </if>
      <if test="password != null" >
        password,
      </if>
      <if test="userName != null" >
        user_name,
      </if>
      <if test="jobNum != null" >
        job_num,
      </if>
      <if test="openid != null" >
        openid,
      </if>
      <if test="category != null" >
        category,
      </if>
      <if test="reference != null" >
        reference,
      </if>
      <if test="mobile != null" >
        mobile,
      </if>
      <if test="email != null" >
        email,
      </if>
      <if test="phone != null" >
        phone,
      </if>
      <if test="identityType != null" >
        identity_type,
      </if>
      <if test="identityNum != null" >
        identity_num,
      </if>
      <if test="img != null" >
        img,
      </if>
      <if test="address != null" >
        address,
      </if>
      <if test="sex != null" >
        sex,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="checkStatus != null" >
        check_status,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="loginName != null" >
        #{loginName,jdbcType=VARCHAR},
      </if>
      <if test="salt != null" >
        #{salt,jdbcType=VARCHAR},
      </if>
      <if test="password != null" >
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="userName != null" >
        #{userName,jdbcType=VARCHAR},
      </if>
      <if test="jobNum != null" >
        #{jobNum,jdbcType=VARCHAR},
      </if>
      <if test="openid != null" >
        #{openid,jdbcType=VARCHAR},
      </if>
      <if test="category != null" >
        #{category,jdbcType=BIGINT},
      </if>
      <if test="reference != null" >
        #{reference,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null" >
        #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="email != null" >
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="phone != null" >
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="identityType != null" >
        #{identityType,jdbcType=BIGINT},
      </if>
      <if test="identityNum != null" >
        #{identityNum,jdbcType=VARCHAR},
      </if>
      <if test="img != null" >
        #{img,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        #{address,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        #{sex,jdbcType=BIGINT},
      </if>
      <if test="status != null" >
        #{status,jdbcType=INTEGER},
      </if>
      <if test="checkStatus != null" >
         #{checkStatus,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update f_user
    <set >
      <if test="loginName != null" >
        login_name = #{loginName,jdbcType=VARCHAR},
      </if>
      <if test="salt != null" >
        salt = #{salt,jdbcType=VARCHAR},
      </if>
      <if test="password != null" >
        password = #{password,jdbcType=VARCHAR},
      </if>
      <if test="userName != null" >
        user_name = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="jobNum != null" >
        job_num = #{jobNum,jdbcType=VARCHAR},
      </if>
      <if test="openid != null" >
        openid = #{openid,jdbcType=VARCHAR},
      </if>
      <if test="category != null" >
        category = #{category,jdbcType=BIGINT},
      </if>
      <if test="reference != null" >
        reference = #{reference,jdbcType=VARCHAR},
      </if>
      <if test="mobile != null" >
        mobile = #{mobile,jdbcType=VARCHAR},
      </if>
      <if test="email != null" >
        email = #{email,jdbcType=VARCHAR},
      </if>
      <if test="phone != null" >
        phone = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="identityType != null" >
        identity_type = #{identityType,jdbcType=BIGINT},
      </if>
      <if test="identityNum != null" >
        identity_num = #{identityNum,jdbcType=VARCHAR},
      </if>
      <if test="img != null" >
        img = #{img,jdbcType=VARCHAR},
      </if>
      <if test="address != null" >
        address = #{address,jdbcType=VARCHAR},
      </if>
      <if test="sex != null" >
        sex = #{sex,jdbcType=BIGINT},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="checkStatus != null" >
        check_status = #{checkStatus,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
    </set>
    where pk_id = #{pkId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update f_user
    set login_name = #{loginName,jdbcType=VARCHAR},
      salt = #{salt,jdbcType=VARCHAR},
      password = #{password,jdbcType=VARCHAR},
      user_name = #{userName,jdbcType=VARCHAR},
      job_num = #{jobNum,jdbcType=VARCHAR},
      openid = #{openid,jdbcType=VARCHAR},
      category = #{category,jdbcType=BIGINT},
      reference = #{reference,jdbcType=VARCHAR},
      mobile = #{mobile,jdbcType=VARCHAR},
      email = #{email,jdbcType=VARCHAR},
      phone = #{phone,jdbcType=VARCHAR},
      identity_type = #{identityType,jdbcType=BIGINT},
      identity_num = #{identityNum,jdbcType=VARCHAR},
      img = #{img,jdbcType=VARCHAR},
      address = #{address,jdbcType=VARCHAR},
      sex = #{sex,jdbcType=BIGINT},
      status = #{status,jdbcType=INTEGER},
      check_status = #{checkStatus,jdbcType=INTEGER},
      create_time = #{createTime,jdbcType=TIMESTAMP}
    where pk_id = #{pkId,jdbcType=BIGINT}
  </update>
  <cache type="org.mybatis.caches.ehcache.EhcacheCache" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
  </cache>
  <resultMap id="AliasResultMap" type="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="F_USER_PK_ID" property="pkId" jdbcType="BIGINT" />
    <result column="F_USER_LOGIN_NAME" property="loginName" jdbcType="VARCHAR" />
    <result column="F_USER_SALT" property="salt" jdbcType="VARCHAR" />
    <result column="F_USER_PASSWORD" property="password" jdbcType="VARCHAR" />
    <result column="F_USER_USER_NAME" property="userName" jdbcType="VARCHAR" />
    <result column="F_USER_JOB_NUM" property="jobNum" jdbcType="VARCHAR" />
    <result column="F_USER_OPENID" property="openid" jdbcType="VARCHAR" />
    <result column="F_USER_CATEGORY" property="category" jdbcType="BIGINT" />
    <result column="F_USER_REFERENCE" property="reference" jdbcType="VARCHAR" />
    <result column="F_USER_MOBILE" property="mobile" jdbcType="VARCHAR" />
    <result column="F_USER_EMAIL" property="email" jdbcType="VARCHAR" />
    <result column="F_USER_PHONE" property="phone" jdbcType="VARCHAR" />
    <result column="F_USER_IDENTITY_TYPE" property="identityType" jdbcType="BIGINT" />
    <result column="F_USER_IDENTITY_NUM" property="identityNum" jdbcType="VARCHAR" />
    <result column="F_USER_IMG" property="img" jdbcType="VARCHAR" />
    <result column="F_USER_ADDRESS" property="address" jdbcType="VARCHAR" />
    <result column="F_USER_SEX" property="sex" jdbcType="BIGINT" />
    <result column="F_USER_STATUS" property="status" jdbcType="INTEGER" />
    <result column="F_USER_CHECK_STATUS" property="checkStatus" jdbcType="INTEGER" />
    <result column="F_USER_CREATE_TIME" property="createTime" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Alias_Column_List" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    F_USER.PK_ID			AS	F_USER_PK_ID,
	F_USER.LOGIN_NAME		AS	F_USER_LOGIN_NAME,
	F_USER.SALT				AS	F_USER_SALT,
	F_USER.PASSWORD			AS	F_USER_PASSWORD,
	F_USER.USER_NAME		AS	F_USER_USER_NAME,
	F_USER.JOB_NUM			AS	F_USER_JOB_NUM,
	F_USER.OPENID			AS	F_USER_OPENID,
	F_USER.CATEGORY			AS	F_USER_CATEGORY,
	F_USER.REFERENCE		AS	F_USER_REFERENCE,
	F_USER.MOBILE			AS	F_USER_MOBILE,
	F_USER.EMAIL			AS	F_USER_EMAIL,
	F_USER.PHONE			AS	F_USER_PHONE,
	F_USER.IDENTITY_TYPE	AS	F_USER_IDENTITY_TYPE,
	F_USER.IDENTITY_NUM		AS	F_USER_IDENTITY_NUM,
	F_USER.IMG				AS	F_USER_IMG,
	F_USER.ADDRESS			AS	F_USER_ADDRESS,
	F_USER.SEX				AS	F_USER_SEX,
	F_USER.STATUS			AS	F_USER_STATUS,
	F_USER.CHECK_STATUS		AS	F_USER_CHECK_STATUS,
	F_USER.CREATE_TIME		AS	F_USER_CREATE_TIME
  </sql>
  <!--
      以上由华源格林统一开发平台代码生成器自动生成，请在下方添加自定义的sql。 
  -->
  
  
  <select id="selectAll" resultMap="BaseResultMap" parameterType="com.hyetec.uap.wechat.vo.UserVo" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
     pk_id pkId, login_name loginName, salt, password, user_name userName, job_num jobNum, openid, category, reference, 
    mobile, email, phone, identity_type identityType, identity_num identityNum, img, address, sex, status, check_status checkStatus,
     check_status oldStatus,create_time createTime
    from f_user
    <where>
    	<if test="user != null">
    		<if test="user.userName != null and user.userName != ''" >
    			and user_name like concat('%',#{user.userName},'%')
    		</if>
    		<if test="user.checkStatus != null and user.checkStatus != ''" >
    			and check_status = #{user.checkStatus}
    		</if>
    		<if test="user.category != null and user.category != ''" >
    			and category = #{user.category}
    		</if>
    	</if>
    </where>
  </select>
  
  <select id="checkUserName" resultType="java.lang.Integer" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select  count(*) from f_user
    <where>
    	<if test="loginName != null and loginName != ''" >
    			and login_name = #{loginName}
    	</if>
    	<if test="pkId != null and pkId != ''" >
    			and pk_id != #{pkId}
    	</if>
    </where>
  </select>
  
  <select id="checkMobile" resultType="java.lang.Integer" parameterType="com.hyetec.uap.wechat.model.User" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select  count(*) from f_user
    <where>
    	<if test="mobile != null and mobile != ''" >
    			and mobile = #{mobile}
    	</if>
    	<if test="pkId != null and pkId != ''" >
    			and pk_id != #{pkId}
    	</if>
    </where>
  </select>
  
  <select id="select" resultMap="BaseResultMap" parameterType="com.hyetec.uap.wechat.model.User" >
  	select
  	<include refid="Base_Column_List"></include>  
  	from f_user
    <where>
     	<if test="pkId != null" >
        pk_id = #{pkId,jdbcType=BIGINT}   
     	</if>
     	<if test="userName != null and  userName != '' " >
        and user_name  =#{userName,jdbcType=VARCHAR}   
        </if>
        <if test="loginName != null and  loginName != '' " >
        and login_name = #{loginName,jdbcType=VARCHAR}   
        </if>
        <if test="mobile != null and  mobile != '' " >
        and mobile = #{mobile,jdbcType=VARCHAR}   
        </if>
        <!-- <if test="code != null and  code != '' " >
        code = #{code,jdbcType=VARCHAR}  and 
        </if>
     	<if test="email != null  and  email!= '' " >
        email = #{email,jdbcType=VARCHAR}  and 
        </if>
     	<if test="mobile != null and  mobile!= '' " >
        mobile = #{email,jdbcType=VARCHAR}  and 
        </if>
    	<if test="phone != null and  phone!= '' " >
        phone = #{phone,jdbcType=VARCHAR}  and 
        </if>
  		<if test="status != null" >
          status = #{status,jdbcType=BIT} and 
     	 </if>
    	 del_flag = 0   -->
    </where>
    
    
  </select>
  
  <!-- <select id="selectAllcustomer" resultMap="BaseResultMap"  parameterType="java.util.Map">
    
 
       
	select 
	<include refid="Base_Column_List" />
	from f_user where category = #{category} and pk_id != #{myuserid}
  </select> -->
  
  <update id="updatePw" parameterType="com.hyetec.uap.wechat.model.User">
  	 update f_user 
  	 	set password = #{password,jdbcType=VARCHAR},
  	 		 salt =  #{salt,jdbcType=VARCHAR}
  	 		where mobile = #{mobile,jdbcType=VARCHAR}
  </update>
  
  <select id="login" parameterType="java.lang.String" resultMap="BaseResultMap">
  
  	select 
	<include refid="Base_Column_List" />
	from f_user
	
		<where>
			<if test="_parameter !=null and _parameter != '' ">
				mobile = #{_parameter} or login_name = #{_parameter}
			</if>
		</where>
  
  </select>
  
  <select id="selectAllUser" resultMap="BaseResultMap" >
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from f_user where category = 5
    
  </select>
  
  <select id="selectAllUserByname" resultMap="BaseResultMap"  parameterType="com.hyetec.uap.wechat.model.User">
    <!--
      WARNING - @hyetec
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from f_user
    <where>
  		 user_name like concat('%',#{userName},'%') and category = 5
    </where>
  </select>
  
  <select id="adminlogin" parameterType="java.lang.String"  resultType="com.hyetec.uap.wechat.model.User">
  	SELECT
  	  a.login_name loginName, a.salt salt  , a. password password
  	 FROM f_user a 
	LEFT JOIN f_dictionary b ON b.sort = a.category 
	<where>
				 b.`name` = '管理员' and	login_name = #{name}
		
	</where>
  </select>
  
</mapper>